import{g as S}from"./index-D1Pc-dgb.js";import"@capacitor/core";var p="https://js.stripe.com/v3",E=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var y=function(){for(var r=document.querySelectorAll('script[src^="'.concat(p,'"]')),e=0;e<r.length;e++){var o=r[e];if(E.test(o.src))return o}return null},l=function(r){var e="",o=document.createElement("script");o.src="".concat(p).concat(e);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(o),o},g=function(r,e){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"3.4.1",startTime:e})},a=null,s=null,u=null,P=function(r){return function(){r(new Error("Failed to load Stripe.js"))}},_=function(r,e){return function(){window.Stripe?r(window.Stripe):e(new Error("Stripe.js not available"))}},L=function(r){return a!==null?a:(a=new Promise(function(e,o){if(typeof window>"u"||typeof document>"u"){e(null);return}if(window.Stripe){e(window.Stripe);return}try{var n=y();if(!(n&&r)){if(!n)n=l(r);else if(n&&u!==null&&s!==null){var i;n.removeEventListener("load",u),n.removeEventListener("error",s),(i=n.parentNode)===null||i===void 0||i.removeChild(n),n=l(r)}}u=_(e,o),s=P(o),n.addEventListener("load",u),n.addEventListener("error",s)}catch(h){o(h);return}}),a.catch(function(e){return a=null,Promise.reject(e)}))},I=function(r,e,o){if(r===null)return null;var n=r.apply(void 0,e);return g(n,o),n},c,m=!1,f=function(){return c||(c=L(null).catch(function(r){return c=null,Promise.reject(r)}),c)};Promise.resolve().then(function(){return f()}).catch(function(t){m||console.warn(t)});var j=function(){for(var r=arguments.length,e=new Array(r),o=0;o<r;o++)e[o]=arguments[o];m=!0;var n=Date.now();return f().then(function(i){return I(i,e,n)})},b={};let d=null;const C=()=>(d||(d=j(b.VITE_STRIPE_PUBLIC_KEY)),d),v=async t=>{try{const r=await S(),e=t==="remove_ads"?r.price_remove_ads:r.price_premium_phrases;if(!e.startsWith("price_"))throw console.error("El priceId no es válido para Stripe:",e),new Error("ID de precio inválido");return e}catch(r){throw console.error("Error obteniendo clave de producto:",r),new Error("No se pudo obtener el producto de Stripe")}},w=async t=>{try{const r=await C(),{error:e}=await r.redirectToCheckout({lineItems:[{price:t,quantity:1}],mode:"payment",successUrl:window.location.href,cancelUrl:window.location.href});if(e)throw console.error("Error redirigiendo a Stripe Checkout:",e),new Error(e.message)}catch(r){throw console.error("Error creando sesión de checkout:",r),new Error("No se pudo procesar el pago. Inténtalo más tarde.")}},x=async()=>{try{const t=await v("remove_ads");return await w(t),!0}catch(t){return console.error("Error procesando pago Remove Ads:",t),!1}},A=async()=>{try{const t=await v("premium_phrases");return await w(t),!0}catch(t){return console.error("Error procesando pago Premium:",t),!1}};export{w as createCheckoutSession,v as getProductKey,C as getStripe,A as handlePremiumPayment,x as handleRemoveAdsPayment};
//# sourceMappingURL=stripeService-DKfzySe5.js.map
